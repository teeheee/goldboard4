\hypertarget{i2c_8h}{}\section{/home/alex/workspace/goldboard4/libs/goldboard4/i2c.h File Reference}
\label{i2c_8h}\index{/home/alex/workspace/goldboard4/libs/goldboard4/i2c.\+h@{/home/alex/workspace/goldboard4/libs/goldboard4/i2c.\+h}}


I2\+C-\/\+Treiber, derzeit nur Master, interruptbasiert.  


{\ttfamily \#include \char`\"{}global.\+h\char`\"{}}\\*
{\ttfamily \#include $<$stdbool.\+h$>$}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$util/twi.\+h$>$}\\*
Include dependency graph for i2c.\+h\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{i2c_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{i2c_8h__dep__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define {\bfseries T\+W\+\_\+\+T\+I\+M\+E\+O\+U\+T\+\_\+\+E\+R\+R\+OR}~0x\+FF\hypertarget{i2c_8h_a5cc0a1876a3d4815d6a9a69bce653c04}{}\label{i2c_8h_a5cc0a1876a3d4815d6a9a69bce653c04}

\item 
\#define {\bfseries I2\+C\+\_\+\+O\+N\+\_\+\+E\+R\+R\+O\+R\+\_\+\+F\+A\+T\+AL}\hypertarget{i2c_8h_ad8c710658fa32f2f8974d6d357dcd9c5}{}\label{i2c_8h_ad8c710658fa32f2f8974d6d357dcd9c5}

\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
boolean \hyperlink{i2c_8h_abc18fd0461e5c6b433285335acac0cc9}{i2c\+Is\+Complete} (void)
\item 
boolean {\bfseries i2c\+Check\+Ack} (uint8\+\_\+t address)\hypertarget{i2c_8h_aaac167b570f1dc5c40e5987a3813af79}{}\label{i2c_8h_aaac167b570f1dc5c40e5987a3813af79}

\item 
uint8\+\_\+t \hyperlink{i2c_8h_a1091488ad34f5e8990091aa6b01fb8c9}{i2c\+Get\+Last\+Error} (void)
\item 
void \hyperlink{i2c_8h_af41a62505fd4ca300eeed25ac1de911c}{i2c\+Init} (uint16\+\_\+t bitrate\+K\+Hz)
\item 
void {\bfseries i2c\+Close} (void)\hypertarget{i2c_8h_a51b2aeb913a9c0512f9ddccf5fa38ea9}{}\label{i2c_8h_a51b2aeb913a9c0512f9ddccf5fa38ea9}

\item 
bool \hyperlink{i2c_8h_ac4d5f5ff28c1f69c741b81e225d16e40}{i2c\+Transfer} (uint8\+\_\+t address, uint8\+\_\+t $\ast$p\+Tx, uint8\+\_\+t n\+Tx, uint8\+\_\+t $\ast$p\+Rx, uint8\+\_\+t n\+Rx)
\item 
bool \hyperlink{i2c_8h_a4c27e5b9ba55b6f1b5acc89d680eccc8}{i2c\+Read} (uint8\+\_\+t address, uint8\+\_\+t reg, uint8\+\_\+t $\ast$p\+Rx, uint8\+\_\+t n\+Rx)
\item 
bool {\bfseries i2c\+Read\+Register} (uint8\+\_\+t address, uint8\+\_\+t reg, uint8\+\_\+t $\ast$data)\hypertarget{i2c_8h_ad5dda112cafeca6dff8f28ce5f74a99c}{}\label{i2c_8h_ad5dda112cafeca6dff8f28ce5f74a99c}

\item 
bool \hyperlink{i2c_8h_a83fbf015492a78db2816a105738d392e}{i2c\+Write\+Register} (uint8\+\_\+t address, uint8\+\_\+t reg, uint8\+\_\+t data)
\item 
bool {\bfseries i2c\+Write\+To\+Slave} (uint8\+\_\+t address, uint8\+\_\+t $\ast$buf, int count)\hypertarget{i2c_8h_a71c6d51fa5ea99f0cd2adffd5cd44508}{}\label{i2c_8h_a71c6d51fa5ea99f0cd2adffd5cd44508}

\item 
uint8\+\_\+t \hyperlink{i2c_8h_a11775628753d9e39e692171f1a88927b}{i2c\+Wait} (void)
\item 
void \hyperlink{i2c_8h_ad7c22c019c4a90ad53ec546a3f8d80a0}{i2c\+Test} (void)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
I2\+C-\/\+Treiber, derzeit nur Master, interruptbasiert. 

\begin{DoxyAuthor}{Author}
Timo Sandmann (\href{mailto:mail@timosandmann.de}{\tt mail@timosandmann.\+de}) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
05.\+09.\+2007
\end{DoxyDate}
Changes by Roman Steiger \begin{DoxyDate}{Date}
17.\+01.\+2008 
\end{DoxyDate}


\subsection{Function Documentation}
\index{i2c.\+h@{i2c.\+h}!i2c\+Get\+Last\+Error@{i2c\+Get\+Last\+Error}}
\index{i2c\+Get\+Last\+Error@{i2c\+Get\+Last\+Error}!i2c.\+h@{i2c.\+h}}
\subsubsection[{\texorpdfstring{i2c\+Get\+Last\+Error(void)}{i2cGetLastError(void)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t i2c\+Get\+Last\+Error (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{i2c_8h_a1091488ad34f5e8990091aa6b01fb8c9}{}\label{i2c_8h_a1091488ad34f5e8990091aa6b01fb8c9}
T\+W\+\_\+\+N\+O\+\_\+\+I\+N\+FO if no error occured \index{i2c.\+h@{i2c.\+h}!i2c\+Init@{i2c\+Init}}
\index{i2c\+Init@{i2c\+Init}!i2c.\+h@{i2c.\+h}}
\subsubsection[{\texorpdfstring{i2c\+Init(uint16\+\_\+t bitrate\+K\+Hz)}{i2cInit(uint16_t bitrateKHz)}}]{\setlength{\rightskip}{0pt plus 5cm}void i2c\+Init (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{bitrate\+K\+Hz}
\end{DoxyParamCaption}
)}\hypertarget{i2c_8h_af41a62505fd4ca300eeed25ac1de911c}{}\label{i2c_8h_af41a62505fd4ca300eeed25ac1de911c}
Initialisiert das I2\+C-\/\+Modul 
\begin{DoxyParams}{Parameters}
{\em bitrate} & Init-\/\+Wert in k\+Hz\\
\hline
\end{DoxyParams}
S\+CL frequency = C\+PU Clock frequency / 16 + 2(T\+W\+BR) $\ast$ 4$^\wedge$\+T\+W\+PS ï T\+W\+BR = Value of the T\+WI Bit Rate Register ï T\+W\+PS = Value of the prescaler bits in the T\+WI Status Register \index{i2c.\+h@{i2c.\+h}!i2c\+Is\+Complete@{i2c\+Is\+Complete}}
\index{i2c\+Is\+Complete@{i2c\+Is\+Complete}!i2c.\+h@{i2c.\+h}}
\subsubsection[{\texorpdfstring{i2c\+Is\+Complete(void)}{i2cIsComplete(void)}}]{\setlength{\rightskip}{0pt plus 5cm}boolean i2c\+Is\+Complete (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{i2c_8h_abc18fd0461e5c6b433285335acac0cc9}{}\label{i2c_8h_abc18fd0461e5c6b433285335acac0cc9}
Transfer state. true if transfer is finished; false if transfer is active \index{i2c.\+h@{i2c.\+h}!i2c\+Read@{i2c\+Read}}
\index{i2c\+Read@{i2c\+Read}!i2c.\+h@{i2c.\+h}}
\subsubsection[{\texorpdfstring{i2c\+Read(uint8\+\_\+t address, uint8\+\_\+t reg, uint8\+\_\+t $\ast$p\+Rx, uint8\+\_\+t n\+Rx)}{i2cRead(uint8_t address, uint8_t reg, uint8_t *pRx, uint8_t nRx)}}]{\setlength{\rightskip}{0pt plus 5cm}bool i2c\+Read (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{address, }
\item[{uint8\+\_\+t}]{reg, }
\item[{uint8\+\_\+t $\ast$}]{p\+Rx, }
\item[{uint8\+\_\+t}]{n\+Rx}
\end{DoxyParamCaption}
)}\hypertarget{i2c_8h_a4c27e5b9ba55b6f1b5acc89d680eccc8}{}\label{i2c_8h_a4c27e5b9ba55b6f1b5acc89d680eccc8}
Sendet ein Byte an einen I2\+C-\/\+Slave und liest anschliessend n\+Rx Bytes 
\begin{DoxyParams}{Parameters}
{\em address} & Slave-\/\+Adresse \\
\hline
{\em reg} & Slave Register \\
\hline
{\em $\ast$p\+Rx} & Zeiger auf Puffer fuer zu lesende Daten \\
\hline
{\em n\+Rx} & Anzahl der zu lesenden Bytes \\
\hline
\end{DoxyParams}
\index{i2c.\+h@{i2c.\+h}!i2c\+Test@{i2c\+Test}}
\index{i2c\+Test@{i2c\+Test}!i2c.\+h@{i2c.\+h}}
\subsubsection[{\texorpdfstring{i2c\+Test(void)}{i2cTest(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void i2c\+Test (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{i2c_8h_ad7c22c019c4a90ad53ec546a3f8d80a0}{}\label{i2c_8h_ad7c22c019c4a90ad53ec546a3f8d80a0}
For internal use only! Don\textquotesingle{}t use! \index{i2c.\+h@{i2c.\+h}!i2c\+Transfer@{i2c\+Transfer}}
\index{i2c\+Transfer@{i2c\+Transfer}!i2c.\+h@{i2c.\+h}}
\subsubsection[{\texorpdfstring{i2c\+Transfer(uint8\+\_\+t address, uint8\+\_\+t $\ast$p\+Tx, uint8\+\_\+t n\+Tx, uint8\+\_\+t $\ast$p\+Rx, uint8\+\_\+t n\+Rx)}{i2cTransfer(uint8_t address, uint8_t *pTx, uint8_t nTx, uint8_t *pRx, uint8_t nRx)}}]{\setlength{\rightskip}{0pt plus 5cm}bool i2c\+Transfer (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{address, }
\item[{uint8\+\_\+t $\ast$}]{p\+Tx, }
\item[{uint8\+\_\+t}]{n\+Tx, }
\item[{uint8\+\_\+t $\ast$}]{p\+Rx, }
\item[{uint8\+\_\+t}]{n\+Rx}
\end{DoxyParamCaption}
)}\hypertarget{i2c_8h_ac4d5f5ff28c1f69c741b81e225d16e40}{}\label{i2c_8h_ac4d5f5ff28c1f69c741b81e225d16e40}
Sendet n\+Tx Bytes an einen I2\+C-\/\+Slave und liest anschliessend n\+Rx Bytes 
\begin{DoxyParams}{Parameters}
{\em address} & Slave-\/\+Adresse \\
\hline
{\em $\ast$p\+Tx} & Zeiger auf Puffer fuer zu sendende Daten \\
\hline
{\em n\+Tx} & Anzahl der zu sendenden Bytes \\
\hline
{\em $\ast$p\+Rx} & Zeiger auf Puffer fuer zu lesende Daten \\
\hline
{\em n\+Rx} & Anzahl der zu lesenden Bytes \\
\hline
\end{DoxyParams}
\index{i2c.\+h@{i2c.\+h}!i2c\+Wait@{i2c\+Wait}}
\index{i2c\+Wait@{i2c\+Wait}!i2c.\+h@{i2c.\+h}}
\subsubsection[{\texorpdfstring{i2c\+Wait(void)}{i2cWait(void)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t i2c\+Wait (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{i2c_8h_a11775628753d9e39e692171f1a88927b}{}\label{i2c_8h_a11775628753d9e39e692171f1a88927b}
Wartet, bis der aktuelle I2\+C-\/\+Transfer beendet ist \begin{DoxyReturn}{Returns}
T\+W\+\_\+\+N\+O\+\_\+\+I\+N\+FO (0xf8) falls alles ok, sonst Fehlercode 
\end{DoxyReturn}
\index{i2c.\+h@{i2c.\+h}!i2c\+Write\+Register@{i2c\+Write\+Register}}
\index{i2c\+Write\+Register@{i2c\+Write\+Register}!i2c.\+h@{i2c.\+h}}
\subsubsection[{\texorpdfstring{i2c\+Write\+Register(uint8\+\_\+t address, uint8\+\_\+t reg, uint8\+\_\+t data)}{i2cWriteRegister(uint8_t address, uint8_t reg, uint8_t data)}}]{\setlength{\rightskip}{0pt plus 5cm}bool i2c\+Write\+Register (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t}]{address, }
\item[{uint8\+\_\+t}]{reg, }
\item[{uint8\+\_\+t}]{data}
\end{DoxyParamCaption}
)}\hypertarget{i2c_8h_a83fbf015492a78db2816a105738d392e}{}\label{i2c_8h_a83fbf015492a78db2816a105738d392e}
Sendet ein Kommando und ein Byte an einen I2\+C-\/\+Slave 
\begin{DoxyParams}{Parameters}
{\em address} & Slave-\/\+Adresse \\
\hline
{\em reg} & Slave register, das zunaechst an den Slave gesendet wird \\
\hline
{\em data} & Byte, das anschlieﬂend an den Slave gesendet wird \\
\hline
\end{DoxyParams}
